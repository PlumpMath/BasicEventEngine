language: cpp
sudo: required

dist: trusty
compiler: gcc
os: linux

before_install:
  - sudo add-apt-repository ppa:ubuntu-toolchain-r/test -y
  - sudo apt-get update -qq
  - sudo apt-get install -qq cmake libsdl2-dev libsdl2-image-dev libsdl2-ttf-dev libsdl2-mixer-dev libsdl2-net-dev libglew-dev libglm-dev freeglut3-dev libxmu-dev
  - if [ "$CXX" = "g++" ]; then sudo apt-get install -qq g++-4.9; fi
  - if [ "$CXX" = "g++" ]; then export CXX="g++-4.9" CC="gcc-4.9"; fi
  - curl -s https://packagecloud.io/install/repositories/github/git-lfs/script.deb.sh | sudo bash
  - sudo apt-get install -qq git-lfs
  - git lfs init
  - git pull
before_script:
  - mkdir build
  - cd build
  - cmake ..
script: make
after_success:
  - cd ..
  - export DISPLAY=:99
  - export AUDIODEV=null
  - sudo apt-get install -qq mesa-utils libgl1-mesa-swx11 libgl1-mesa-swx11-dev xvfb
  - /sbin/start-stop-daemon --start --quiet --pidfile /tmp/custom_xvfb_99.pid --make-pidfile --background --exec /usr/bin/Xvfb -- :99 -screen 0 1920x1080x24 -ac +extension GLX +extension RANDR +render -noreset
  - sleep 3
  - ./build/BasicEventEngine --single-run --sdl
